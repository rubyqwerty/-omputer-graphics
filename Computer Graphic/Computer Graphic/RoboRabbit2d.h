#pragma once
#include <string>
#include <map>
#include "Roborabbit.h"

class RoboRabbit2d : public RoboRabbit {
public:
	
	RoboRabbit2d() {
		coordinate = {
		{-70, 240},
		{-30,240},
		{30,240},
		{70,240},
		{-90,180},
		{-70,180},
		{-30,180},
		{30,180},
		{70,180},
		{90,180},
		{-70,160},
		{-30,160},
		{30,160},
		{70,160},
		{-110,120},
		{-90,120},
		{-70,120},
		{-30,120},
		{30,120},
		{70,120},
		{90,120},
		{110,120},
		{-90,100},
		{90,100},
		{-90,80},
		{90,80},
		{-110,60},
		{-90,60},
		{90,60},
		{110,60},
		{-190,40},
		{-90,40},
		{90,40},
		{190,40},
		{-150,0},
		{150,0},
		{-190,-60},
		{-150,-60},
		{150,-60},
		{190,-60},
		{-90,-80},
		{-70,-80},
		{70,-80},
		{90,-80},
		{-70,-120},
		{-50,-120},
		{-10,-120},
		{10,-120},
		{50,-120},
		{70,-120},
		{-90,-180},
		{-50,-180},
		{-10,-180},
		{10,-180},
		{50,-180},
		{90,-180},
		{-90,-220},
		{-10,-220},
		{10,-220},
		{90,-220},
		{-90,0},
		{90, 0}
		};
		graph = {
{0, {1,5}},
{1, {0,6}},
{2, {3,7}},
{3, {2,8}},
{4, {5,15}},
{5, {0,4,6}},
{6, {1,5,7}},
{7, {2,6,8}},
{8, {3,7,9}},
{9, {8}},
{10, {11,16}},
{11, {10,17}},
{12, {13,18}},
{13, {12,19}},
{14, {15,26}},
{15, {4,14,16}},
{16, {10,15,17}},
{17, {11,16,18}},
{18, {12,17,19}},
{19, {13,18,20}},
{20, {9,19,21}},
{21, {20,29}},
{22, {23,24}},
{23, {22,25}},
{24, {22,25}},
{25, {23,24}},
{26, {14,27}},
{27, {26,28,31}},
{28, {27,29,32}},
{29, {21,28}},
{30, {31,36}},
{31, {27,30,40}},
{32, {28,33,43}},
{33, {32,39}},
{34, {37,60}},
{35, {38,61}},
{36, {37}},
{37, {}},
{38, {}},
{39, {38}},
{40, {43}},
{41, {44}},
{42, {49}},
{43, {}},
{44, {49}},
{45, {51}},
{46, {52}},
{47, {53}},
{48, {54}},
{49, {}},
{50, {52,56}},
{51, {}},
{52, {57}},
{53, {55,58}},
{54, {}},
{55, {59}},
{56, {57}},
{57, {}},
{58, {59}},
{59, {}},
{60, {}},
{61, {}},
		};
	}

public:
	// Поворот
	void Turn(double a) {
		vector <vector<double>> RotationMatrix{
			{cos(a) , sin(a), 0,0}, {-sin(a), cos(a),0,0}, {0,0,1,0}, {0,0,0,0}
		};
		DoNewImage(RotationMatrix);
	}
	
	// Изменение размера
	void ChangeSize(pair<double, double> a) {
		vector <vector<double>> ScaleMatrix{
			{a.first,0,0,0}, {0,a.second,0,0}, {0,0,1,0}, {0,0,0,0}
		};
		DoNewImage(ScaleMatrix);
	}
	
	// Перемещение 
	void Move(pair<double, double> a) {
		vector <vector<double>> MoveMatrix{
			{1,0,a.first,0}, {0,1,a.second,0}, {0,0,1,0}, {0,0,0,0}
		};
		DoNewImage(MoveMatrix);
	}

	// анимация растягивания
	void Poisoning() {
		double ratio = 1;
		for (double i = 0.01; ; i += 0.03 * ratio) {
			if (!PoisoningWork) return;
			ChangeSize({ i,1 });
			if (i >= 1) ratio = -1;
			if (i <= 0) ratio = 1;
		}
	}
};

